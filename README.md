# Создание кастомной WordPress темы

1. [Начнём с готового](#Начнём с готового)
2. [Установка](#Установка)
3. [Кастомизируем](#Кастомизируем)
4. [Переносим управление контентом в настройки страницы/поста](#Переносим управление контентом в настройки страницы/поста)
5. [Кастомные типы страниц/постов](#Кастомные типы страниц/постов)
6. [Полезные плагины](#Полезные плагины)

## Начнём с готового
Не нужно изобретать велосипед и начинать с нуля, для старта хорошо использовать [Underscores тему](https://underscores.me/)

Сделать это можно через сайт [https://underscores.me/](https://underscores.me/), плюсом будет, что тут есть сразу поля ввода для имени вашей будущей темы, описания темы, имя автора, ссылка на автора. Удобно:) Ввел -> подтвердил -> получил архив с заполненным конфигом и уже переименованную папку под имя твоего проекта.

Второй способ: скачать архив с их гит репозитория [https://github.com/automattic/_s](https://github.com/automattic/_s), но тогда Вам нужно будет выполнить ряд измененний, которые указаны у них в README.md репозитория

## Установка
Загружаем самую свежую версию WordPress с официального сайта. Распаковываем и скидываем нашу тему по адресу `/корень_сайта/wp-content/themes/`

## Кастомизируем
Замените дефолтное изображение проекта `screenshot.png` на скрин страницы или изображение логотипа. Размер должен быть 1400x900

## Переносим управление контентом в настройки страницы/поста
Смену всего динамического контента нужно реализовать максимально легко для менеджера/админа сайта. Для этого используем [AdvancedCustomFields](https://www.advancedcustomfields.com/)
Хорошо приобрести его платное дополнение для создания повторяющихся полей(например изображений в слайдере) - [Repeater Field](https://www.advancedcustomfields.com/add-ons/repeater-field/)
Одна покупка на все сайты и пожизненное обновление, на этом фоне цена в 25$ звучит смешно.
### Кратко как использовать
После установки плагина у нас появится вкладка "Произвольные поля" в сайдбаре админки. Переходим -> Добавляем новую запись -> Выбираем правило в каком обьекте WP появятся наши доп. поля.

При создании стоит понимать, что `Имя поля` это его будущее название переменной. Я использую БЭМ именование и поля называю, если например применять наши доп. поля применимы по правилу к типу постов `Projects`, тогда все имена полей я начинаю с `projects__` (`projects__name`, `projects__addition-image`)

Созданное поле появится в выбранном по правилам обьекте. А вывести его можно по разному, в зависимости от типа, который ему выбрали. 
* Если нужно запомнить значение в переменной тогда подойдет запись `<?php $value = get_field("имя_поля"); ?>`
* Другой случай - вывод в конкретном месте, тогда в выбранном месте пишем `<?php the_field("имя_поля")`
Подробнее на сайте плагина в [Документации](https://www.advancedcustomfields.com/resources/)
## Кастомные типы страниц/постов
Просто пары полей может быть мало для полной свободы действий и универсальности решения. Например по ТЗ у нас есть три типа постов полностью отличных друг от друга по внешнему виду и типу контента - ПРОЕКТЫ, БИБЛИОТЕКА, НОВОСТИ. Для начала нам нужно добавить эти сущности в WP. Для этого идем в наш файлик `functions.php`, который лежит в папке нашей темы и в конце делаем запись `require get_template_directory() . '/inc/post-types.php';`

> Это можно было бы и не писать и все обьявления делать тут же в файлике, но так будет удобнее и файлик `functions.php` будет чище.

Создаем файл `post-types.php` в папке `inc`, которая лежит там же где и наш `functions.php`

В файлике описываем новую сущность с помощью данного кода:
```
<?php
function project_post_type() {
	$labels = array(
		'name'                => _x( 'Проекты', 'Post Type General Name', 'имя_темы' ),
		'singular_name'       => _x( 'Проект', 'Post Type Singular Name', 'имя_темы' ),
		'menu_name'           => __( 'Проекты', 'имя_темы' ),
		'name_admin_bar'      => __( 'Проекты', 'имя_темы' ),
		'parent_item_colon'   => __( 'Родительский элемент:', 'имя_темы' ),
		'all_items'           => __( 'Все Проекты', 'имя_темы' ),
		'add_new_item'        => __( 'Добавить новый проект', 'имя_темы' ),
		'add_new'             => __( 'Добавить новый', 'имя_темы' ),
		'new_item'            => __( 'Новый', 'имя_темы' ),
		'edit_item'           => __( 'Редактировать', 'имя_темы' ),
		'update_item'         => __( 'Обновить', 'имя_темы' ),
		'view_item'           => __( 'Посмотреть', 'имя_темы' ),
		'search_items'        => __( 'Искать проект', 'имя_темы' ),
		'not_found'           => __( 'Не найдено', 'имя_темы' ),
		'not_found_in_trash'  => __( 'Не найдено в корзине', 'имя_темы' ),
	);
	$args = array(
		'menu_icon' 		  => 'dashicons-cart',
		'label'               => __( 'projects', 'имя_темы' ),
		'description'         => __( 'Все Проекты на сайте', 'имя_темы' ),
		'labels'              => $labels,
		'supports'            => array( 'title', 'thumbnail', 'revisions', 'page-attributes', ),
		'taxonomies'          => array(),
		'hierarchical'        => false,
		'public'              => true,
		'show_ui'             => true,
		'show_in_menu'        => true,
		'menu_position'       => 5,
		'show_in_admin_bar'   => true,
		'show_in_nav_menus'   => true,
		'can_export'          => true,
		'has_archive'         => false,
		'exclude_from_search' => false,
		'publicly_queryable'  => true,
		'capability_type'     => 'page',
	);
	register_post_type( 'project', $args );
}
add_action( 'init', 'project_post_type', 0 );
```
Подробнее можно почитать [тут](https://codex.wordpress.org/Post_Types)
## Полезные плагины
### Управление Robots.txt с админки
В дальнейшем это будет неплохо, если сеошник или владелец сайта смогут просто менять robots.txt. Я использую [https://wordpress.org/plugins-wp/wp-robots-txt/](https://wordpress.org/plugins-wp/wp-robots-txt/)
### Клонирование постов/страниц
Добавляем кнопку "Клонировать" для облегченного создания дублированного контента. [https://wordpress.org/plugins-wp/post-duplicator/](https://wordpress.org/plugins-wp/post-duplicator/)
### Исключаем автоформатирование от WordPress
WP очень любит добавлять лишние `<p>` и удалять "лишние" `<div>`. Во избежание стоит установить [Raw HTML](https://wordpress.org/plugins-wp/raw-html/)
### Сжатие медиафайлов
Для экономии нервов и места на сайте будет 100% надо установить [WP Smush](https://wordpress.org/plugins-wp/wp-smushit/)